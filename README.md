# MK Mall - E-Commerce Platform

Полнофункциональная платформа электронной коммерции с админ-панелью, личным кабинетом клиента, системой заказов и реферальной программой.

## Возможности

### Для клиентов:
- Просмотр товаров по категориям с поиском
- Корзина покупок с несколькими способами оплаты (Баланс, Карта, Наличные при доставке)
- Личный кабинет с 3 вкладками:
  - **Обзор**: Просмотр баланса, пополнение/вывод средств, история транзакций
  - **Заказы**: История заказов с детальной информацией и отслеживанием статуса
  - **Рефералы**: Реферальный код, отслеживание рефералов и бонусов
- Реферальная система с бонусом $10 при первом заказе реферала
- Полный процесс оформления заказа с адресом и выбором способа оплаты
- Обновление баланса в реальном времени

### Для администраторов:
- Управление товарами (добавление, редактирование, удаление с загрузкой изображений)
- Управление транзакциями (одобрение/отклонение депозитов и выводов с указанием причины)
- Просмотр всех транзакций пользователей по статусам
- Отслеживание всех заказов и активности пользователей

## Начальная настройка

### 1. Создание администратора

Для создания администратора:

1. Зарегистрируйте новый аккаунт через форму регистрации
2. Обновите роль в Supabase SQL Editor:

```sql
UPDATE profiles
SET role = 'admin'
WHERE email = 'ваш@email.com';
```

### 2. Тестирование приложения

#### Как администратор:
1. Войдите с учетной записью администратора
2. Управляйте товарами во вкладке "Products"
3. Управляйте транзакциями во вкладке "Transactions"

#### Как клиент:
1. Зарегистрируйтесь (можно указать реферальный код)
2. Просматривайте товары и добавляйте в корзину
3. Используйте личный кабинет для управления балансом
4. Оформляйте заказы с выбором способа оплаты
5. Делитесь реферальным кодом и получайте бонусы

## Структура базы данных

### Таблицы:
- **profiles**: Профили пользователей с ролью, балансом и реферальными кодами
- **products**: Каталог товаров с изображениями и ценами
- **transactions**: Запросы на депозит и вывод с системой одобрения
- **orders**: Заказы клиентов с отслеживанием статуса
- **order_items**: Товары в каждом заказе
- **referrals**: Отслеживание рефералов и бонусов

### Хранилище:
- **product-images**: Публичное хранилище для изображений товаров

## Основные процессы

### Процесс заказа:
1. Клиент добавляет товары в корзину
2. Оформляет заказ с адресом доставки
3. Выбирает способ оплаты
4. При оплате балансом сумма списывается сразу
5. Заказ создается со статусом "pending"
6. При завершении первого заказа реферал получает бонус

### Процесс депозита:
1. Клиент запрашивает депозит
2. Создается транзакция "pending"
3. Администратор одобряет/отклоняет
4. При одобрении баланс автоматически обновляется

### Процесс вывода:
1. Клиент запрашивает вывод
2. Создается транзакция "pending"
3. Администратор одобряет/отклоняет с указанием причины
4. При одобрении баланс автоматически уменьшается

### Реферальная программа:
1. Новый пользователь регистрируется с реферальным кодом
2. Совершает первый заказ
3. После завершения заказа:
   - Создается запись реферала с бонусом $10
   - Баланс реферера увеличивается на $10

## Безопасность
- Row Level Security (RLS) на всех таблицах
- Пользователи видят только свои данные
- Администраторы имеют полный доступ
- Загрузка изображений только для администраторов
- Обновление баланса через защищенные триггеры базы данных

## Цветовая схема
- Основной золотой: #f5b04c
- Основной бирюзовый: #2a5f64

## Деплой

Проект готов к деплою на Vercel. Подробная инструкция в файле [DEPLOY.md](./DEPLOY.md).

**Быстрый старт:**
1. Запушьте проект в GitHub
2. Подключите репозиторий к Vercel
3. Добавьте переменные окружения из `.env`
4. Подключите домен mgsouk.com
5. Каждый `git push` будет автоматически деплоиться

## Технологии
- **Frontend**: React 18 + TypeScript + Vite
- **Styling**: Tailwind CSS
- **Database**: Supabase (PostgreSQL)
- **Auth**: Supabase Auth
- **Storage**: Supabase Storage
- **Icons**: Lucide React
- **Hosting**: Vercel
